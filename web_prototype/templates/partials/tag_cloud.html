{% if enabled %}
    {% set sorted_tags = tag_profile.items()|sort(attribute='1', reverse=True)|list %}
    <div class="flex flex-wrap gap-2">
        {% for tag, weight in sorted_tags[:30] %}
            {% if tag in blacklisted_tags %}
                <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700 line-through opacity-50">
                    {{ tag }}
                </span>
            {% else %}
                {% set size_class = 'text-sm font-semibold' if loop.index <= 3 else 'text-sm' if loop.index <= 8 else 'text-xs' %}
                {% set bg_class = 'bg-primary-200' if loop.index <= 3 else 'bg-primary-100' %}
                <span class="inline-flex items-center px-2.5 py-1 rounded-full {{ size_class }} bg-primary-100 text-primary-700">
                    {{ tag }}
                </span>
            {% endif %}
        {% endfor %}
    </div>

    {% if sorted_tags|length > 30 %}
    <p class="text-xs text-slate-500 mt-2">Showing top 30 of {{ sorted_tags|length }} tags</p>
    {% endif %}

    <div class="mt-3 pt-3 border-t border-slate-200">
        <div class="flex items-center gap-3 text-xs text-slate-600">
            <div class="flex items-center gap-1.5">
                <div class="w-2 h-2 rounded-full bg-primary-100"></div>
                <span>Your taste profile</span>
            </div>
            <div class="flex items-center gap-1.5">
                <div class="w-2 h-2 rounded-full bg-red-100"></div>
                <span>Blacklisted</span>
            </div>
        </div>
    </div>
{% else %}
    <div class="text-center py-8 text-slate-400">
        <svg class="mx-auto h-12 w-12 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
        </svg>
        <p class="text-sm">Tag similarity disabled</p>
        <p class="text-xs mt-1">Enable above to see your taste profile tags</p>
    </div>
{% endif %}
